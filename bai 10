CREATE TABLE departments (
    department_id   SERIAL PRIMARY KEY,
    department_name VARCHAR(100) NOT NULL
);

CREATE TABLE employees (
    employee_id     SERIAL PRIMARY KEY,
    employee_name   VARCHAR(100) NOT NULL,
    salary          NUMERIC(15,2),
    department_id   INT REFERENCES departments(department_id)
);

SELECT
    e.employee_id,
    e.employee_name,
    d.department_name
FROM employees e
INNER JOIN departments d
    ON e.department_id = d.department_id;


SELECT
    d.department_name,
    AVG(e.salary) AS avg_salary
FROM departments d
JOIN employees e
    ON e.department_id = d.department_id
GROUP BY d.department_name;

SELECT
    d.department_name,
    AVG(e.salary) AS avg_salary
FROM departments d
JOIN employees e
    ON e.department_id = d.department_id
GROUP BY d.department_name
HAVING AVG(e.salary) > 10000000;

SELECT
    d.department_id,
    d.department_name
FROM departments d
LEFT JOIN employees e
    ON e.department_id = d.department_id
WHERE e.employee_id IS NULL;
